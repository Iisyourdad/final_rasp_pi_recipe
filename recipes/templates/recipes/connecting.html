<!DOCTYPE html><html><head><meta charset="utf-8"><title>Connecting…</title>
<style>
  body{margin:0;height:100vh;display:flex;align-items:center;justify-content:center;font-family:sans-serif;background:#f5f5f5}
  .spinner{border:8px solid #eee;border-top:8px solid #4285F4;border-radius:50%;width:60px;height:60px;animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  h2{text-align:center;margin-top:1rem;color:#333}
</style></head>
<body>
  <div><div class="spinner"></div><h2>Connecting…</h2></div>
  <script>
    function getCookie(n){let v=document.cookie.split(';').map(c=>c.trim()).find(c=>c.startsWith(n+'=')); return v?decodeURIComponent(v.split('=')[1]):'';}
    document.addEventListener('DOMContentLoaded',_=>{
      fetch("{% url 'wifi_do_connect' %}",{
        method:'POST',
        headers:{
          'Content-Type':'application/json',
          'X-CSRFToken':getCookie('csrftoken')
        },
        body:JSON.stringify({
          ssid:"{{ ssid|escapejs }}",
          password:"{{ password|escapejs }}"
        })
      })
      .then(r=>r.json())
      .then(d=>{
        if(d.status==='ok') location.href='/';
        else          location.href='/wifi/?error='+encodeURIComponent(d.error);
      })
      .catch(_=>location.href='/wifi/?error=fetch-error');
    });
  </script>
</body></html>
